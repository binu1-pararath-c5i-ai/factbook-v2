table V_Dim_FB_CustChainHeir
	lineageTag: 1c7aa9e9-78e3-4c26-bb37-3c04a418bab1

	column CustomerID
		dataType: string
		lineageTag: 37dc1ef6-a815-46d4-97a4-45f29b843d62
		summarizeBy: none
		sourceColumn: CustomerID

		annotation SummarizationSetBy = Automatic

	column CustomerNumber
		dataType: string
		lineageTag: 924b35f6-ea40-4869-a22d-81d93284bd36
		summarizeBy: none
		sourceColumn: CustomerNumber

		annotation SummarizationSetBy = Automatic

	column CustomerName
		dataType: string
		lineageTag: d3681976-4a72-4125-8443-e3e5360011f5
		summarizeBy: none
		sourceColumn: CustomerName

		annotation SummarizationSetBy = Automatic

	column IsAccountActive
		dataType: double
		lineageTag: ddb9a488-7959-4283-bf6f-63a7e89a21f7
		summarizeBy: sum
		sourceColumn: IsAccountActive

		annotation SummarizationSetBy = Automatic

		annotation PBI_FormatHint = {"isGeneralNumber":true}

	column StoreFormat
		dataType: string
		lineageTag: 40a9b841-f060-4e1d-9b48-e34517a27981
		summarizeBy: none
		sourceColumn: StoreFormat

		annotation SummarizationSetBy = Automatic

	column StoreFormatDesc
		dataType: string
		lineageTag: ddeeb510-49a4-464a-87bd-8a9bafd087b1
		summarizeBy: none
		sourceColumn: StoreFormatDesc

		annotation SummarizationSetBy = Automatic

	column Address
		dataType: string
		lineageTag: e4376ea1-fb42-4072-aba4-da16505ad98a
		summarizeBy: none
		sourceColumn: Address

		annotation SummarizationSetBy = Automatic

	column City
		dataType: string
		lineageTag: d604ac9d-5109-4883-ad7f-9470d73dcb1f
		summarizeBy: none
		sourceColumn: City

		annotation SummarizationSetBy = Automatic

	column State
		dataType: string
		lineageTag: 6bf538fc-49d5-4b37-85b8-cc4bb6ed5c7d
		summarizeBy: none
		sourceColumn: State

		annotation SummarizationSetBy = Automatic

	column ZipCode
		dataType: string
		lineageTag: 6db75f87-ff9c-4fec-a428-fac5d3476d84
		summarizeBy: none
		sourceColumn: ZipCode

		annotation SummarizationSetBy = Automatic

	column Country
		dataType: string
		lineageTag: a491874f-e8dc-4c8a-9e94-2fe5513ee2ef
		summarizeBy: none
		sourceColumn: Country

		annotation SummarizationSetBy = Automatic

	column ChannelID
		dataType: string
		lineageTag: 4a5d2691-82df-4e25-873a-69b05dee5a73
		summarizeBy: none
		sourceColumn: ChannelID

		annotation SummarizationSetBy = Automatic

	column ChannelDesc
		dataType: string
		lineageTag: e2fc2875-9546-4a54-9496-7c8fa22e93ae
		summarizeBy: none
		sourceColumn: ChannelDesc

		annotation SummarizationSetBy = Automatic

	column SuperChannelID
		dataType: string
		lineageTag: ddfe49fc-fb70-4172-86f8-7975c4013d53
		summarizeBy: none
		sourceColumn: SuperChannelID

		annotation SummarizationSetBy = Automatic

	column SuperChannelDesc
		dataType: string
		lineageTag: 33a2930f-ca6c-4bca-8348-63bb5e28759c
		summarizeBy: none
		sourceColumn: SuperChannelDesc

		annotation SummarizationSetBy = Automatic

	column LocalChainID
		dataType: string
		lineageTag: dbb638f0-9418-4001-8f6f-39e984d68802
		summarizeBy: none
		sourceColumn: LocalChainID

		annotation SummarizationSetBy = Automatic

	column LocalChainName
		dataType: string
		lineageTag: ebe4c4ed-20a5-4203-99a7-d79edf2addb1
		summarizeBy: none
		sourceColumn: LocalChainName

		annotation SummarizationSetBy = Automatic

	column RegionalChainID
		dataType: string
		lineageTag: efb8dac2-3f6b-4580-ac1c-ff50cef14111
		summarizeBy: none
		sourceColumn: RegionalChainID

		annotation SummarizationSetBy = Automatic

	column RegionalChainName
		dataType: string
		lineageTag: 19d843ac-76c2-41a1-846b-4f88ebb38191
		summarizeBy: none
		sourceColumn: RegionalChainName

		annotation SummarizationSetBy = Automatic

	column NationalChainID
		dataType: string
		lineageTag: 2f3df65f-eca1-4836-9e3a-89cb84440d90
		summarizeBy: none
		sourceColumn: NationalChainID

		annotation SummarizationSetBy = Automatic

	column NationalChainName
		dataType: string
		lineageTag: 7d77325c-e4ae-458f-90e2-2fcfec628b44
		summarizeBy: none
		sourceColumn: NationalChainName

		annotation SummarizationSetBy = Automatic

	column SalesGroupID
		dataType: string
		lineageTag: c8267268-c151-4ef2-8914-d449a244f581
		summarizeBy: none
		sourceColumn: SalesGroupID

		annotation SummarizationSetBy = Automatic

	column SalesGroupName
		dataType: string
		lineageTag: 9f7d30d5-08e5-4513-9d2a-1b2d4f2f5d74
		summarizeBy: none
		sourceColumn: SalesGroupName

		annotation SummarizationSetBy = Automatic

	column BranchID
		dataType: string
		lineageTag: 025d2871-207d-4ea6-846e-b9fb13d95f6a
		summarizeBy: none
		sourceColumn: BranchID

		annotation SummarizationSetBy = Automatic

	column BranchName
		dataType: string
		lineageTag: df0b6dbf-d4f6-439f-b6e2-d17a8e9c07a8
		summarizeBy: none
		sourceColumn: BranchName

		annotation SummarizationSetBy = Automatic

	column TerritoryID
		dataType: string
		lineageTag: e86eb51b-98d3-4795-b593-d12567f7c874
		summarizeBy: none
		sourceColumn: TerritoryID

		annotation SummarizationSetBy = Automatic

	column TerritoryName
		dataType: string
		lineageTag: 01334730-30a5-460f-ac03-1a9fbc50bc23
		summarizeBy: none
		sourceColumn: TerritoryName

		annotation SummarizationSetBy = Automatic

	column RegionID
		dataType: string
		lineageTag: d5269937-6567-4ce5-902a-b1ddd5c68329
		summarizeBy: none
		sourceColumn: RegionID

		annotation SummarizationSetBy = Automatic

	column RegionName
		dataType: string
		lineageTag: 9515e978-337f-4b3e-90b3-baf9367f77cd
		summarizeBy: none
		sourceColumn: RegionName

		annotation SummarizationSetBy = Automatic

	column BUID
		dataType: string
		lineageTag: cc083971-69e9-4a03-8c4e-282e4f6b5f6c
		summarizeBy: none
		sourceColumn: BUID

		annotation SummarizationSetBy = Automatic

	column BUName
		dataType: string
		lineageTag: 4f4caf3c-2259-4f82-bee1-a8e35be20b34
		summarizeBy: none
		sourceColumn: BUName

		annotation SummarizationSetBy = Automatic

	column PromoPlan
		dataType: string
		lineageTag: 24ea6738-8f9a-4823-9e36-6e987b0178bb
		summarizeBy: none
		sourceColumn: PromoPlan

		annotation SummarizationSetBy = Automatic

	column PromoPlanName
		dataType: string
		lineageTag: 4cb43e4f-0b64-4f44-9ce8-427603941fcc
		summarizeBy: none
		sourceColumn: PromoPlanName

		annotation SummarizationSetBy = Automatic

	column RouteID
		dataType: string
		lineageTag: 1e7899de-8a2e-47d0-a246-e3773d03cf46
		summarizeBy: none
		sourceColumn: RouteID

		annotation SummarizationSetBy = Automatic

	column RouteName
		dataType: string
		lineageTag: d5aa6ff3-1952-4284-8f5d-a82499f5119a
		summarizeBy: none
		sourceColumn: RouteName

		annotation SummarizationSetBy = Automatic

	column CustomerAccountAssignmentGroup
		dataType: string
		lineageTag: 17910e2e-c83c-4f57-9476-a4d013b7c668
		summarizeBy: none
		sourceColumn: CustomerAccountAssignmentGroup

		annotation SummarizationSetBy = Automatic

	column Tier
		dataType: string
		lineageTag: b871111a-63c2-46ed-983c-320000d7a44d
		summarizeBy: none
		sourceColumn: Tier

		annotation SummarizationSetBy = Automatic

	column CSDPromo
		dataType: double
		lineageTag: 6bc5c468-06a9-490a-8327-89839165c0cd
		summarizeBy: sum
		sourceColumn: CSDPromo

		annotation SummarizationSetBy = Automatic

		annotation PBI_FormatHint = {"isGeneralNumber":true}

	column EneryPromo
		dataType: double
		lineageTag: bad779c7-d0ea-4de5-aa87-98e3fd040bd6
		summarizeBy: sum
		sourceColumn: EneryPromo

		annotation SummarizationSetBy = Automatic

		annotation PBI_FormatHint = {"isGeneralNumber":true}

	column SportsPromo
		dataType: double
		lineageTag: d8969c41-dd61-4e16-85da-8ed9aa6b0c7d
		summarizeBy: sum
		sourceColumn: SportsPromo

		annotation SummarizationSetBy = Automatic

		annotation PBI_FormatHint = {"isGeneralNumber":true}

	column WaterPromo
		dataType: double
		lineageTag: 39dcfaf0-ca37-4fc0-8ed4-0753db2df8e5
		summarizeBy: sum
		sourceColumn: WaterPromo

		annotation SummarizationSetBy = Automatic

		annotation PBI_FormatHint = {"isGeneralNumber":true}

	column TeaJCPromo
		dataType: double
		lineageTag: 4fadf803-7023-4af0-924c-ddc67de2b665
		summarizeBy: sum
		sourceColumn: TeaJCPromo

		annotation SummarizationSetBy = Automatic

		annotation PBI_FormatHint = {"isGeneralNumber":true}

	column DistributionChannel
		dataType: string
		lineageTag: 95df0353-7056-41ce-8c0e-5beb684578f0
		summarizeBy: none
		sourceColumn: DistributionChannel

		annotation SummarizationSetBy = Automatic

	column Division
		dataType: string
		lineageTag: d609ccfe-dbda-49cd-8da2-14de311869f4
		summarizeBy: none
		sourceColumn: Division

		annotation SummarizationSetBy = Automatic

	column DSDNetworkCapacity_Channel
		dataType: string
		lineageTag: 49c17274-f7d3-47be-a77a-6d5469b8cc16
		summarizeBy: none
		sourceColumn: DSDNetworkCapacity_Channel

		annotation SummarizationSetBy = Automatic

	column 'Channel category' =
			
			SWITCH(
			    TRUE(),
			    V_Dim_FB_CustChainHeir[DSDNetworkCapacity_Channel] IN {"CHAIN GROCERY"}, "GROCERY",
			    V_Dim_FB_CustChainHeir[DSDNetworkCapacity_Channel] IN {"MASS", "MASS ALL OTHER"}, "MASS",
			    V_Dim_FB_CustChainHeir[DSDNetworkCapacity_Channel] IN {"CHAIN DRUG", "DOLLAR STORES"}, "DRUG/DOLLAR",
			    V_Dim_FB_CustChainHeir[DSDNetworkCapacity_Channel] IN {"CHAIN CONVENIENCE", "INDEPEND CONVENIENCE"}, "CONVENIENCE",
			//    V_Dim_FB_CustChainHeir[DSDNetworkCapacity_Channel] IN {"CASUAL DINING MEXICA"}, "CASUAL DINING MEXICA",
			     "ALL OTHERS")
		lineageTag: c6f065c3-93f4-402e-be5f-1a77b22a645e
		summarizeBy: none

		annotation SummarizationSetBy = Automatic

	column 'Composite Key' = V_Dim_FB_CustChainHeir[CustomerNumber]&V_Dim_FB_CustChainHeir[DistributionChannel]
		lineageTag: 3be2bc1f-1b8e-4b93-8000-3553ff7a3aeb
		summarizeBy: none

		annotation SummarizationSetBy = Automatic

	column OrderFrequency
		dataType: string
		lineageTag: 0141ae35-f2b2-42bb-9e31-de9393ab939f
		summarizeBy: none
		sourceColumn: OrderFrequency

		annotation SummarizationSetBy = Automatic

	column BranchNationalChain
		dataType: string
		lineageTag: b0219016-e326-4dc6-8f15-b2c6e940e8cf
		summarizeBy: none
		sourceColumn: BranchNationalChain

		annotation SummarizationSetBy = Automatic

	column SalesGroupLocalChain
		dataType: string
		lineageTag: 1f82d870-aed6-430c-85d4-ded95d4af8f7
		summarizeBy: none
		sourceColumn: SalesGroupLocalChain

		annotation SummarizationSetBy = Automatic

	column Customer = V_Dim_FB_CustChainHeir[CustomerNumber]&" - "&V_Dim_FB_CustChainHeir[CustomerName]
		lineageTag: 2684a28d-339c-4c93-a3c0-4d51e4618359
		summarizeBy: none

		annotation SummarizationSetBy = Automatic

	column TerritoryName_Filtered
		dataType: string
		lineageTag: 58794d62-0a2d-4e0c-9c5a-66f6a8ed7520
		summarizeBy: none
		sourceColumn: TerritoryName_Filtered

		annotation SummarizationSetBy = Automatic

	column RegionName_Filtered
		dataType: string
		lineageTag: 071925d8-8dae-48d8-bf28-aa568ee48a72
		summarizeBy: none
		sourceColumn: RegionName_Filtered

		annotation SummarizationSetBy = Automatic

	column BUName_Filtered
		dataType: string
		lineageTag: cf5aff8a-1584-4627-9326-090083a2f203
		summarizeBy: none
		sourceColumn: BUName_Filtered

		annotation SummarizationSetBy = Automatic

	column SAP_SalesGroupID
		dataType: string
		lineageTag: b05fc6d9-d661-47c2-9e21-eb38335f2d89
		summarizeBy: none
		sourceColumn: SAP_SalesGroupID

		annotation SummarizationSetBy = Automatic

	column SAP_SalesGroupName
		dataType: string
		lineageTag: fb8b6fc5-6cf6-402a-977e-8d13d9e2191e
		summarizeBy: none
		sourceColumn: SAP_SalesGroupName

		annotation SummarizationSetBy = Automatic

	column SAP_BranchID
		dataType: string
		lineageTag: 4eb800cf-bd3c-4b18-9dc2-28c31f967e64
		summarizeBy: none
		sourceColumn: SAP_BranchID

		annotation SummarizationSetBy = Automatic

	column SAP_BranchName
		dataType: string
		lineageTag: 0f4f4de1-be1f-438f-9acb-15740df34d0d
		summarizeBy: none
		sourceColumn: SAP_BranchName

		annotation SummarizationSetBy = Automatic

	column SAP_TerritoryID
		dataType: string
		lineageTag: 518cf151-69f8-43f2-9a3c-ec89f504257f
		summarizeBy: none
		sourceColumn: SAP_TerritoryID

		annotation SummarizationSetBy = Automatic

	column SAP_TerritoryName
		dataType: string
		lineageTag: 949fc395-15de-46d3-b094-b84baa63497d
		summarizeBy: none
		sourceColumn: SAP_TerritoryName

		annotation SummarizationSetBy = Automatic

	column SAP_RegionID
		dataType: string
		lineageTag: 18c50cac-117d-45b5-9e3f-d0fd43d62e7f
		summarizeBy: none
		sourceColumn: SAP_RegionID

		annotation SummarizationSetBy = Automatic

	column SAP_RegionName
		dataType: string
		lineageTag: 54ce7848-1781-42b4-9fe8-e150863ed7f7
		summarizeBy: none
		sourceColumn: SAP_RegionName

		annotation SummarizationSetBy = Automatic

	column SAP_BUID
		dataType: string
		lineageTag: 92df75c2-449c-4851-a758-51d3be015fba
		summarizeBy: none
		sourceColumn: SAP_BUID

		annotation SummarizationSetBy = Automatic

	column SAP_BUName
		dataType: string
		lineageTag: 3317f6a0-1b84-434f-ba68-ceac24330818
		summarizeBy: none
		sourceColumn: SAP_BUName

		annotation SummarizationSetBy = Automatic

	column 'Channel category new' = V_Dim_FB_CustChainHeir[Channel category]
		lineageTag: acd823a0-06d2-4042-a31e-04f1993fc7f8
		summarizeBy: none
		sortByColumn: 'Channel Category Sort'

		changedProperty = SortByColumn

		annotation SummarizationSetBy = Automatic

	column 'Channel Category Sort' =
			
			SWITCH(
			    TRUE(),
			    V_Dim_FB_CustChainHeir[Channel category] = "GROCERY",2,
			    V_Dim_FB_CustChainHeir[Channel category] = "MASS",1,
			    V_Dim_FB_CustChainHeir[Channel category] = "DRUG/DOLLAR",3,
			    V_Dim_FB_CustChainHeir[Channel category] = "CONVENIENCE",4,
			//     V_Dim_FB_CustChainHeir[DSDNetworkCapacity_Channel] IN {"CASUAL DINING MEXICA"}, "CASUAL DINING MEXICA",
			     V_Dim_FB_CustChainHeir[Channel category] ="ALL OTHERS",5)
		formatString: 0
		lineageTag: 852bb1b6-3020-4c3a-a711-fce900522ba7
		summarizeBy: sum

		annotation SummarizationSetBy = Automatic

	column _RolledStop_Key = V_Dim_FB_CustChainHeir[BranchID]&V_Dim_FB_CustChainHeir[LocalChainID]&V_Dim_FB_CustChainHeir[DistributionChannel]
		lineageTag: 5f1e7ce0-991a-4f08-bdd8-4dac46af2715
		summarizeBy: none

		annotation SummarizationSetBy = Automatic

	hierarchy 'Topline BU hierarchy'
		lineageTag: b388a09f-4ffd-47b7-8850-db74326a6e59

		level BUName
			lineageTag: f87326b5-6340-4ba4-ac5b-622f1f6affff
			column: BUName

		level RegionName
			lineageTag: a9f8bef0-22cb-40ed-9751-a3affa5e8839
			column: RegionName

		level TerritoryName
			lineageTag: d1ad5b22-b36e-4cef-9567-215f11b21f66
			column: TerritoryName

		level BranchName
			lineageTag: 43b2f11f-d48c-48e9-a7b1-bde69b12e014
			column: BranchName

	hierarchy 'Retailer Hierarchy'
		lineageTag: 5a18ffa1-0dc9-4e4a-809c-343f6e56fb07

		level ChannelDesc
			lineageTag: 7dc830e7-b817-4b3e-92da-0a14df4e4503
			column: ChannelDesc

		level NationalChainName
			lineageTag: 586995b9-1841-4e9c-aefd-06cf9d8ad58f
			column: NationalChainName

	hierarchy 'Topline Hierarchy'
		lineageTag: 1adcc47d-35ea-43f2-b54c-bd1cb8e1abf3

		level RegionName
			lineageTag: 73430c75-83a4-4ccb-b943-8dc82c31066e
			column: RegionName

		level TerritoryName
			lineageTag: 406a6e30-2b8d-4183-b896-30bcf4c97275
			column: TerritoryName

		level BranchName
			lineageTag: 3659ef02-c02d-41a0-a2d4-af29850f56da
			column: BranchName

		level SalesGroupName
			lineageTag: b9c7ea25-619b-4032-bf89-4b55e03a0d1e
			column: SalesGroupName

	partition V_Dim_FB_CustChainHeir = m
		mode: import
		source =
				let
				    Source = Snowflake.Databases(#"Snowflake Server",#"Snowflake Warehouse",[Implementation="2.0"]),
				    SOLUTIONS_DEV_Database = Source{[Name=Snowflake_DataBase,Kind="Database"]}[Data],
				    DSD_Schema = SOLUTIONS_DEV_Database{[Name=Snowflake_Schema,Kind="Schema"]}[Data],
				    V_Dim_FB_CustChainHeir_View = DSD_Schema{[Name="V_Dim_FB_CustChainHeir",Kind="View"]}[Data]
				in
				    V_Dim_FB_CustChainHeir_View

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Table

