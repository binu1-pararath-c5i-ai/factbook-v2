table Operation_Cal_Day
	lineageTag: 4f833bfd-bb9e-46b9-a153-bdcb6fbd4602

	column DayDate
		formatString: dd MMM yyyy
		lineageTag: 5fb27668-70e8-4e0e-9edd-96774b76ea1d
		summarizeBy: none
		isNameInferred
		sourceColumn: V_Dim_FB_CalDay[DayDate]

		annotation SummarizationSetBy = Automatic

		annotation PBI_FormatHint = {"isCustom":true}

	column Date_flag = ```
			
			var _today = [CD]
			RETURN 
			SWITCH(
			    TRUE(),
			    'Operation_Cal_Day'[DayDate] > _today, 0, 1)
			```
		formatString: 0
		lineageTag: 7e3b7047-9675-4ece-95d1-5597f4c8bad2
		summarizeBy: sum

		annotation SummarizationSetBy = Automatic

	column FirstDayOfMonth
		formatString: dd MMM yyyy
		lineageTag: a1277862-e3df-4733-b9c8-74db9ffb65e3
		summarizeBy: none
		isNameInferred
		sourceColumn: V_Dim_FB_CalDay[FirstDayOfMonth]

		annotation SummarizationSetBy = Automatic

	column FirstDayOfYear
		formatString: dd MMM yyyy
		lineageTag: 3c59a3fd-1232-44ad-8f45-f282f97496bf
		summarizeBy: none
		isNameInferred
		sourceColumn: V_Dim_FB_CalDay[FirstDayOfYear]

		annotation SummarizationSetBy = Automatic

	column FirstDayOfQuarter
		formatString: dd MMM yyyy
		lineageTag: e9c14e3c-9107-4cde-a536-006d002d1553
		summarizeBy: none
		isNameInferred
		sourceColumn: V_Dim_FB_CalDay[FirstDayOfQuarter]

		annotation SummarizationSetBy = Automatic

	column POG_Flag =
			
			IF (Operation_Cal_Day[Period Level Sort] = 12.2, 0,
			    IF (Operation_Cal_Day[Period Level Sort] <> MONTH([CD]), 1,
			        IF (Operation_Cal_Day[Period Level Sort] = MONTH([CD]) &&
			            WEEKNUM(Operation_Cal_Day[DayDate], 2) = WEEKNUM([CD], 2), 1, 0
			        )
			    )
			)
		formatString: 0
		lineageTag: 690d39cd-20a7-4122-8097-60682dfba1ed
		summarizeBy: sum

		annotation SummarizationSetBy = Automatic

	column WeekStarting_ISO
		formatString: dd MMM yyyy
		lineageTag: 6f243b08-17d7-4f8e-9db6-961a743fd790
		summarizeBy: none
		isNameInferred
		sourceColumn: V_Dim_FB_CalDay[WeekStarting_ISO]

		annotation SummarizationSetBy = Automatic

	column Year
		formatString: 0
		lineageTag: e88101a9-35d4-4b55-91a1-953e0b914b04
		summarizeBy: sum
		isNameInferred
		sourceColumn: V_Dim_FB_CalDay[Year]

		annotation SummarizationSetBy = Automatic

	column YearID
		lineageTag: 96e84de2-e2d7-4718-bf27-12b1ad858c3a
		summarizeBy: none
		isNameInferred
		sourceColumn: V_Dim_FB_CalDay[YearID]

		annotation SummarizationSetBy = Automatic

	column Quarter
		lineageTag: f9d84f4a-32b2-45e2-b1cb-e4712835a08f
		summarizeBy: sum
		isNameInferred
		sourceColumn: V_Dim_FB_CalDay[Quarter]

		annotation SummarizationSetBy = Automatic

		annotation PBI_FormatHint = {"isGeneralNumber":true}

	column Quarter_Name
		lineageTag: 58fd1647-6bff-476a-bbc5-25368a4b4676
		summarizeBy: none
		isNameInferred
		sourceColumn: V_Dim_FB_CalDay[Quarter_Name]

		annotation SummarizationSetBy = Automatic

	column MonthName
		lineageTag: d9fb2ed1-ddd2-4830-9282-ac7f884d444f
		summarizeBy: none
		isNameInferred
		sourceColumn: V_Dim_FB_CalDay[MonthName]

		annotation SummarizationSetBy = Automatic

	column MonthNumber
		lineageTag: 74846c8e-3cff-4871-9094-bdc75a738e0b
		summarizeBy: sum
		isNameInferred
		sourceColumn: V_Dim_FB_CalDay[MonthNumber]

		annotation SummarizationSetBy = Automatic

		annotation PBI_FormatHint = {"isGeneralNumber":true}

	column CurrWeekCounter_ISO
		lineageTag: c0898d11-d7e0-4bb6-aa8c-8750d8ca76fd
		summarizeBy: sum
		isNameInferred
		sourceColumn: V_Dim_FB_CalDay[CurrWeekCounter_ISO]

		annotation SummarizationSetBy = Automatic

		annotation PBI_FormatHint = {"isGeneralNumber":true}

	column L1
		lineageTag: 95341e51-9c9c-43e6-b778-55b5333ec05f
		summarizeBy: none
		isNameInferred
		sourceColumn: [L1]

		annotation SummarizationSetBy = Automatic

	column L2
		lineageTag: 649c1f4c-ec4a-4c0a-8d9c-fc60841c0565
		summarizeBy: none
		isNameInferred
		sourceColumn: [L2]

		annotation SummarizationSetBy = Automatic

	column L3
		lineageTag: f4a58706-55ae-4a08-b5ae-1f99ec69f209
		summarizeBy: none
		isNameInferred
		sourceColumn: [L3]

		annotation SummarizationSetBy = Automatic

	column 'Period Level Sort'
		lineageTag: 240a3e02-0181-4995-9278-76f326eba2de
		summarizeBy: sum
		isNameInferred
		sourceColumn: [Period Level Sort]

		annotation SummarizationSetBy = Automatic

		annotation PBI_FormatHint = {"isGeneralNumber":true}

	column LYDayDate
		formatString: dd MMM yyyy
		lineageTag: 6d0219ff-698e-4474-b4ef-dfb11ea99908
		summarizeBy: none
		isNameInferred
		sourceColumn: V_Dim_FB_CalDay[LYDayDate]

		annotation SummarizationSetBy = Automatic

	column MonthDesc
		lineageTag: 045c6f0e-56f6-4be0-bbd0-97bf92c4b00f
		summarizeBy: none
		isNameInferred
		sourceColumn: V_Dim_FB_CalDay[MonthDesc]

		annotation SummarizationSetBy = Automatic

	column QuarterDesc
		lineageTag: 14026430-5cfa-4e36-8e96-5190a8edc8f5
		summarizeBy: none
		isNameInferred
		sourceColumn: V_Dim_FB_CalDay[QuarterDesc]

		annotation SummarizationSetBy = Automatic

	partition Operation_Cal_Day = calculated
		mode: import
		source =
				
				VAR data_normal =
				SUMMARIZE(
				    V_Dim_FB_CalDay,
				    V_Dim_FB_CalDay[DayDate],
				    V_Dim_FB_CalDay[Year],
				    V_Dim_FB_CalDay[YearID],
				    V_Dim_FB_CalDay[Quarter],
				    V_Dim_FB_CalDay[Quarter_Name],
				    V_Dim_FB_CalDay[QuarterDesc],
				    V_Dim_FB_CalDay[MonthName],
				    V_Dim_FB_CalDay[MonthNumber],
				    V_Dim_FB_CalDay[MonthDesc],
				    V_Dim_FB_CalDay[FirstDayOfYear],
				    V_Dim_FB_CalDay[FirstDayOfQuarter],
				    V_Dim_FB_CalDay[FirstDayOfMonth],
				    V_Dim_FB_CalDay[WeekStarting_ISO],
				    V_Dim_FB_CalDay[CurrWeekCounter_ISO],
				    V_Dim_FB_CalDay[LYDayDate],
				    // V_Dim_FB_CalDay[Period Level Sort],
				    "Period Level Sort", V_Dim_FB_CalDay[MonthNumber],
				    "L1", V_Dim_FB_CalDay[YearID],
				    "L2", V_Dim_FB_CalDay[Quarter_Name],
				    "L3", V_Dim_FB_CalDay[MonthName]
				)
				VAR data_wk =
				FILTER(
				    SUMMARIZE(
				        V_Dim_FB_CalDay,
				        V_Dim_FB_CalDay[DayDate],
				        V_Dim_FB_CalDay[Year],
				        V_Dim_FB_CalDay[YearID],
				        V_Dim_FB_CalDay[Quarter],
				        V_Dim_FB_CalDay[Quarter_Name],
				        V_Dim_FB_CalDay[QuarterDesc],
				        V_Dim_FB_CalDay[MonthName],
				        V_Dim_FB_CalDay[MonthNumber],
				        V_Dim_FB_CalDay[MonthDesc],
				        V_Dim_FB_CalDay[FirstDayOfYear],
				        V_Dim_FB_CalDay[FirstDayOfQuarter],
				        V_Dim_FB_CalDay[FirstDayOfMonth],
				        V_Dim_FB_CalDay[WeekStarting_ISO],
				        V_Dim_FB_CalDay[CurrWeekCounter_ISO],
				        V_Dim_FB_CalDay[LYDayDate],
				        // V_Dim_FB_CalDay[Period Level Sort],
				        "Period Level Sort", SWITCH(V_Dim_FB_CalDay[CurrWeekCounter_ISO], 0, 12.1, -1, 12.2),
				        "L1", "Weeks",
				        "L2", SWITCH(V_Dim_FB_CalDay[CurrWeekCounter_ISO], 0, "Curr Wk", -1, "Prev Wk"),
				        "L3", "Wk of " & FORMAT(V_Dim_FB_CalDay[Weekstarting_ISO], "MM/DD")
				    ),
				    V_Dim_FB_CalDay[CurrWeekCounter_ISO] IN {0, -1}
				)
				RETURN UNION(data_normal, data_wk)

	annotation PBI_Id = a9565b9f911a4bc9b36e805a9545bd76

