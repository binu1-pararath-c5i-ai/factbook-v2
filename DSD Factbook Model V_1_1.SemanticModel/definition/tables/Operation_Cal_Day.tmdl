table Operation_Cal_Day
	lineageTag: 4f833bfd-bb9e-46b9-a153-bdcb6fbd4602

	column DayDate
		formatString: dd MMM yyyy
		lineageTag: 5fb27668-70e8-4e0e-9edd-96774b76ea1d
		summarizeBy: none
		isNameInferred
		sourceColumn: V_Dim_FB_CalDay[DayDate]

		annotation SummarizationSetBy = Automatic

		annotation PBI_FormatHint = {"isCustom":true}

	column L3
		lineageTag: 6a334850-1ca1-4488-ad49-e9ab73f7af24
		summarizeBy: none
		isNameInferred
		sourceColumn: V_Dim_FB_CalDay[L3]
		sortByColumn: 'Period Level Sort'

		annotation SummarizationSetBy = Automatic

	column Date_flag = ```
			
			var _today = [CD]
			RETURN 
			SWITCH(
			    TRUE(),
			    'Operation_Cal_Day'[DayDate] > _today, 0, 1)
			```
		formatString: 0
		lineageTag: 7e3b7047-9675-4ece-95d1-5597f4c8bad2
		summarizeBy: sum

		annotation SummarizationSetBy = Automatic

	column FirstDayOfMonth
		formatString: General Date
		lineageTag: a1277862-e3df-4733-b9c8-74db9ffb65e3
		summarizeBy: none
		isNameInferred
		sourceColumn: V_Dim_FB_CalDay[FirstDayOfMonth]

		annotation SummarizationSetBy = Automatic

	column 'Period Level Sort'
		lineageTag: 70ade705-92ca-4654-a626-32cf66ea2fba
		summarizeBy: none
		isNameInferred
		sourceColumn: V_Dim_FB_CalDay[Period Level Sort]

		annotation SummarizationSetBy = User

		annotation PBI_FormatHint = {"isGeneralNumber":true}

	column FirstDayOfYear
		formatString: General Date
		lineageTag: 3c59a3fd-1232-44ad-8f45-f282f97496bf
		summarizeBy: none
		isNameInferred
		sourceColumn: V_Dim_FB_CalDay[FirstDayOfYear]

		annotation SummarizationSetBy = Automatic

	column FirstDayOfQuarter
		formatString: General Date
		lineageTag: e9c14e3c-9107-4cde-a536-006d002d1553
		summarizeBy: none
		isNameInferred
		sourceColumn: V_Dim_FB_CalDay[FirstDayOfQuarter]

		annotation SummarizationSetBy = Automatic

	column POG_Flag =
			
			IF (Operation_Cal_Day[Period Level Sort] = 12.2, 0,
			    IF (Operation_Cal_Day[Period Level Sort] <> MONTH([CD]), 1,
			        IF (Operation_Cal_Day[Period Level Sort] = MONTH([CD]) &&
			            WEEKNUM(Operation_Cal_Day[DayDate], 2) = WEEKNUM([CD], 2), 1, 0
			        )
			    )
			)
		formatString: 0
		lineageTag: 690d39cd-20a7-4122-8097-60682dfba1ed
		summarizeBy: sum

		annotation SummarizationSetBy = Automatic

	column L1
		lineageTag: dddc4f9c-af4f-40b2-b72b-9d8f0a79c2eb
		summarizeBy: none
		isNameInferred
		sourceColumn: V_Dim_FB_CalDay[L1]

		annotation SummarizationSetBy = Automatic

	column L2
		lineageTag: d457c0ac-dc9d-4167-b5c6-39e75d99f1bb
		summarizeBy: none
		isNameInferred
		sourceColumn: V_Dim_FB_CalDay[L2]

		annotation SummarizationSetBy = Automatic

	column WeekStarting_ISO
		formatString: General Date
		lineageTag: 6f243b08-17d7-4f8e-9db6-961a743fd790
		summarizeBy: none
		isNameInferred
		sourceColumn: V_Dim_FB_CalDay[WeekStarting_ISO]

		annotation SummarizationSetBy = Automatic

	partition Operation_Cal_Day = calculated
		mode: import
		source = ```
				
				
				var x1 =
				SUMMARIZE(
				    V_Dim_FB_CalDay,
				    V_Dim_FB_CalDay[DayDate],
				    V_Dim_FB_CalDay[YearID],
				    V_Dim_FB_CalDay[Quarter_Name],
				    V_Dim_FB_CalDay[L1],
				    V_Dim_FB_CalDay[L2],
				    V_Dim_FB_CalDay[L3],
				    V_Dim_FB_CalDay[MonthName],
				    V_Dim_FB_CalDay[FirstDayOfYear],
				    V_Dim_FB_CalDay[FirstDayOfQuarter],
				    V_Dim_FB_CalDay[FirstDayOfMonth],
				    V_Dim_FB_CalDay[WeekStarting_ISO],
				    // V_Dim_FB_CalDay[MonthNumber],
				    V_Dim_FB_CalDay[Period Level Sort],
				    "Week-M", IF(SELECTEDVALUE(V_Dim_FB_CalDay[CurrWeekCounter_ISO]) IN {0, -1}, V_Dim_FB_CalDay[L3], BLANK()),
				    "Week-Q", IF(SELECTEDVALUE(V_Dim_FB_CalDay[CurrWeekCounter_ISO]) IN {0, -1}, V_Dim_FB_CalDay[L2], BLANK()),
				    "Week-Y", IF(SELECTEDVALUE(V_Dim_FB_CalDay[CurrWeekCounter_ISO]) IN {0, -1}, V_Dim_FB_CalDay[L1], BLANK())
				)
				 
				var x2 =
				SUMMARIZE(
				    V_Dim_FB_CalDay,
				    V_Dim_FB_CalDay[DayDate],
				    V_Dim_FB_CalDay[YearID],
				    V_Dim_FB_CalDay[Quarter_Name],
				    V_Dim_FB_CalDay[L1],
				    V_Dim_FB_CalDay[L2],
				    V_Dim_FB_CalDay[L3],
				    V_Dim_FB_CalDay[MonthName],
				    V_Dim_FB_CalDay[FirstDayOfYear],
				    V_Dim_FB_CalDay[FirstDayOfQuarter],
				    V_Dim_FB_CalDay[FirstDayOfMonth],
				    V_Dim_FB_CalDay[WeekStarting_ISO],
				    // V_Dim_FB_CalDay[MonthNumber],
				    V_Dim_FB_CalDay[Period Level Sort],
				    "Week-M", V_Dim_FB_CalDay[MonthName],
				    "Week-Q", V_Dim_FB_CalDay[Quarter_Name],
				    "Week-Y", V_Dim_FB_CalDay[L1]
				)
				 
				var data = UNION(x1,x2)
				RETURN 
				SUMMARIZE(
				    data,
				    V_Dim_FB_CalDay[DayDate],
				    V_Dim_FB_CalDay[FirstDayOfYear],
				    V_Dim_FB_CalDay[FirstDayOfQuarter],
				    V_Dim_FB_CalDay[FirstDayOfMonth],
				    V_Dim_FB_CalDay[L3],
				    V_Dim_FB_CalDay[L1],
				    V_Dim_FB_CalDay[L2],
				    V_Dim_FB_CalDay[WeekStarting_ISO],
				    V_Dim_FB_CalDay[Period Level Sort]
				)
				```

	annotation PBI_Id = a9565b9f911a4bc9b36e805a9545bd76

